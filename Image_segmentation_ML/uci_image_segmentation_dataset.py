# -*- coding: utf-8 -*-
"""UCI image segmentation dataset.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/10RFB29BhthNm9QsZxDo-KtFAywMNukFE
"""

# check the GPU version

!/user/local/cuda/bin/nvcc --version
!nvidia-smi

"""### Step 1 import the packages"""

import pandas as pd
from sklearn.svm import SVC
from sklearn.neighbors import KNeighborsClassifier

"""### Step 2 Download the dataset"""

# https://archive.ics.uci.edu/ml/datasets/Image+Segmentation
# Image Segmentation Dataset
!wget https://archive.ics.uci.edu/ml/machine-learning-databases/image/segmentation.data
!wget https://archive.ics.uci.edu/ml/machine-learning-databases/image/segmentation.test

ls

"""### Step 3 Loading the data"""

trn_data = pd.read_csv('segmentation.data',skiprows=3)

trn_data

x_trn = trn_data
y_trn = list(trn_data.index)

"""### Step 4 Initializing the SVM model"""

model = SVC(C=1, kernel = 'rbf', gamma = 'scale')
model.fit(x_trn,y_trn)

tst_data = pd.read_csv('segmentation.test', skiprows=3)

x_tst = tst_data
y_tst = list(tst_data.index)

"""### Step 5 Testing"""

trnAcc = model.score(x_trn,y_trn)
tstAcc = model.score(x_tst,y_tst)
print("Training Accuracy: ", trnAcc)
print("Testing Accuracy: ", tstAcc)

